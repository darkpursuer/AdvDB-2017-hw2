Script started on Tue Nov 14 17:43:40 2017
[?1034hbash-3.2$ exitpsql nyu_adv_database
psql (10.1)
Type "help" for help.

nyu_adv_database=# \timing
Timing is on.
nyu_adv_database=# SELECT
nyu_adv_database-#   stocksymbol,
nyu_adv_database-#   (SUM(quantity*trade.price)/SUM(quantity)) AS average_price
nyu_adv_database-# FROM trade
nyu_adv_database-# GROUP BY stocksymbol;
[?1h= stocksymbol | average_price 
-------------+---------------
           1 |           394
           2 |           285
           3 |            84
           4 |           268
           5 |           224
           6 |           337
           7 |            61
           8 |           460
           9 |           381
          10 |           299
          11 |           479
          12 |           174
          13 |           148
          14 |           406
          15 |           274
          16 |           237
          17 |           426
          18 |           457
          19 |           384
          20 |           130
          21 |           285
          22 |           306
          23 |            66
          24 |           451
          25 |           313
          26 |           216
          27 |           463
          28 |           149
          29 |           390
          30 |           197
          31 |           227
          32 |           225
          33 |           470
          34 |           135
          35 |           338
          36 |           138
          37 |           435
          38 |           207
          39 |           183
          40 |           202
          41 |            96
          42 |            86
          43 |           327
          44 |           482
          45 |           205
          46 |           226
          47 |           303
          48 |           138
          49 |           184
          50 |            81
          51 |           205
          52 |           337
          53 |           232
          54 |            99
          55 |            63
          56 |           257
          57 |           325
          58 |           110
          59 |           423
          60 |           425
          61 |            67
          62 |           390
          63 |           438
          64 |           200
          65 |            94
          66 |            64
          67 |           289
          68 |            86
          69 |           156
          70 |           375
          71 |           191
          72 |           168
          73 |           292
          74 |           206
          75 |           480
          76 |           245
          77 |           270
          78 |           143
          79 |           181
          80 |           202
          81 |           105
          82 |            88
          83 |           133
          84 |            74
          85 |            83
          86 |           388
:[K[K[?1l>Time: 2760.802 ms (00:02.761)
nyu_adv_database=# SELECT t2.stocksymbol, array_agg(t2.avg_prices) AS unweighted_avg
nyu_adv_database-# FROM (
nyu_adv_database(#   SELECT t.stocksymbol,
nyu_adv_database(#     AVG(t.price)
nyu_adv_database(#     OVER(
nyu_adv_database(#       PARTITION BY t.stocksymbol
nyu_adv_database(#       ORDER BY t.time ROWS BETWEEN CURRENT ROW AND 10 FOLLOWING
nyu_adv_database(#       ) AS avg_prices
nyu_adv_database(#   FROM trade t
nyu_adv_database(# ) t2
nyu_adv_database-# GROUP BY t2.stocksymbol;
[?1h= stocksymbol |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      unweighted_avg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
-------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K[K:[K[K:[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K------------------
:[K[K           1 | {365.1818181818181818,367.5454545454545455,369.1818181818181818,370.1818181818181818,371.1818181818181818,371.8181818181818182,372.2727272727272727,372.7272727272727273,372.3636363636363636,372.0000000000000000,372.4545454545454545,372.1818181818181818,371.27272727272727 :[K[K27,370.8181818181818182,370.3636363636363636,369.2727272727272727,368.5454545454545455,368.2727272727272727,367.4545454545454545,366.6363636363636364,365.7272727272727273,364.6363636363636364,364.0000000000000000,363.6363636363636364,363.2727272727272727,363.5454545454545455,364.363636 :[K[K3636363636,365.0000000000000000,365.9090909090909091,367.4545454545454545,369.7272727272727273,372.7272727272727273,375.6363636363636364,378.8181818181818182,381.7272727272727273,385.0000000000000000,387.9090909090909091,390.8181818181818182,393.8181818181818182,396.7272727272727273,39 :[K[K9.5454545454545455,402.1818181818181818,404.4545454545454545,406.8181818181818182,409.0909090909090909,412.0000000000000000,414.0000000000000000,416.0909090909090909,417.7272727272727273,419.4545454545454545,420.5454545454545455,420.8181818181818182,421.0909090909090909,421.18181818181 :[K[K81818,420.9090909090909091,419.8181818181818182,418.3636363636363636,417.0000000000000000,415.9090909090909091,415.0000000000000000,413.4545454545454545,411.8181818181818182,411.0909090909090909,410.5454545454545455,410.5454545454545455,410.3636363636363636,411.0909090909090909,412.181 :[K[K8181818181818,413.2727272727272727,413.4545454545454545,413.8181818181818182,414.4545454545454545,415.3636363636363636,415.6363636363636364,415.7272727272727273,415.1818181818181818,414.6363636363636364,413.7272727272727273,412.9000000000000000,412.3333333333333333,412.2500000000000000 :[K[K,412.0000000000000000,411.5000000000000000,411.0000000000000000,410.7500000000000000,409.6666666666666667,408.5000000000000000,409.0000000000000000}
:[K[K           2 | {256.2727272727272727,255.5454545454545455,254.0909090909090909,253.4545454545454545,253.6363636363636364,254.3636363636363636,254.4545454545454545,254.6363636363636364,254.5454545454545455,254.3636363636363636,254.5454545454545455,254.0909090909090909,253.63636363636363 :[K[K64,253.3636363636363636,252.8181818181818182,251.5454545454545455,250.2727272727272727,249.4545454545454545,249.1818181818181818,249.5454545454545455,250.6363636363636364,251.3636363636363636,252.5454545454545455,254.0000000000000000,255.8181818181818182,257.5454545454545455,260.090909 :[K[K0909090909,262.4545454545454545,264.8181818181818182,266.2727272727272727,267.6363636363636364,268.8181818181818182,269.9090909090909091,270.4545454545454545,270.4545454545454545,270.6363636363636364,270.4545454545454545,269.4545454545454545,268.5454545454545455,267.8181818181818182,26 :[K[K7.4545454545454545,267.1818181818181818,267.2727272727272727,267.3636363636363636,268.0000000000000000,269.1818181818181818,270.0000000000000000,271.4545454545454545,273.6363636363636364,275.6363636363636364,277.0000000000000000,278.0000000000000000,279.1818181818181818,279.81818181818 :[K[K18182,280.8181818181818182,281.0909090909090909,281.5454545454545455,282.2727272727272727,282.3636363636363636,281.8181818181818182,281.5454545454545455,281.9090909090909091,282.2727272727272727,282.2727272727272727,281.9090909090909091,281.1818181818181818,280.6363636363636364,279.909 :[K[K0909090909091,279.2727272727272727,278.8181818181818182,278.4545454545454545,277.3636363636363636,276.1818181818181818,275.9090909090909091,275.9090909090909091,276.7272727272727273,277.3636363636363636,278.0000000000000000,278.4545454545454545,278.9090909090909091,279.8181818181818182 :[K[K,281.2727272727272727,282.8181818181818182,284.1818181818181818,285.0000000000000000,285.6363636363636364,286.2727272727272727,287.8181818181818182,289.9090909090909091,292.5454545454545455,294.2727272727272727,296.0909090909090909,297.9090909090909091,299.5454545454545455,300.72727272 :[K[K72727273,301.6363636363636364,302.2727272727272727,302.3636363636363636,302.1818181818181818,301.4545454545454545,300.5454545454545455,299.9090909090909091,298.5454545454545455,297.0909090909090909,295.6363636363636364,294.0909090909090909,292.4545454545454545,290.6363636363636364,288. :[K[K8181818181818182,286.5454545454545455,284.0909090909090909,281.1818181818181818,278.0909090909090909,275.7272727272727273,273.1818181818181818,271.4545454545454545,270.0909090909090909,269.0909090909090909,268.4545454545454545,267.8181818181818182,267.7272727272727273,267.9090909090909 :[K[K091,268.7272727272727273,270.0909090909090909,271.4545454545454545,273.1818181818181818,275.0000000000000000,276.8181818181818182,278.9090909090909091,281.2727272727272727,283.4545454545454545,285.5454545454545455,287.6363636363636364,289.0000000000000000,289.8181818181818182,289.90909 :[K[K09090909091,290.0000000000000000,289.4545454545454545,288.6363636363636364,287.7272727272727273,286.6363636363636364,286.0909090909090909,285.4545454545454545,284.7272727272727273,284.7272727272727273,284.9090909090909091,285.0909090909090909,284.3636363636363636,284.0909090909090909,2 :[K[K84.6363636363636364,284.9090909090909091,285.0909090909090909,285.2727272727272727,285.0909090909090909,285.4545454545454545,285.6363636363636364,286.4545454545454545,287.6363636363636364,289.4545454545454545,290.7272727272727273,291.7272727272727273,292.7272727272727273,293.8181818181 :[K[K818182,295.0909090909090909,296.7272727272727273,298.2727272727272727,299.9090909090909091,301.3636363636363636,303.0909090909090909,304.1818181818181818,306.0000000000000000,307.3636363636363636,308.7272727272727273,310.0909090909090909,311.5454545454545455,312.7272727272727273,313.90 :[K[K90909090909091,314.6363636363636364,315.0000000000000000,314.7272727272727273,315.0000000000000000,315.1818181818181818,316.0000000000000000,317.0909090909090909,317.7272727272727273,318.1818181818181818,319.2727272727272727,319.9090909090909091,320.3636363636363636,321.090909090909090 :[K[K9,321.6363636363636364,322.3636363636363636,322.3636363636363636,321.7272727272727273,321.2727272727272727,321.4545454545454545,321.7272727272727273,321.1818181818181818,320.7272727272727273,320.9090909090909091,321.1818181818181818,321.5454545454545455,321.5454545454545455,322.2727272 :[K[K727272727,323.0000000000000000,323.5555555555555556,323.7500000000000000,323.4285714285714286,323.6666666666666667,324.4000000000000000,324.5000000000000000,323.6666666666666667,324.0000000000000000,326.0000000000000000}
:[K[K           3 | {105.2727272727272727,106.8181818181818182,107.8181818181818182,108.0909090909090909,107.8181818181818182,107.3636363636363636,106.8181818181818182,105.4545454545454545,103.3636363636363636,100.5454545454545455,97.4545454545454545,94.5454545454545455,91.4545454545454545, :[K[K88.3636363636363636,85.3636363636363636,82.7272727272727273,80.7272727272727273,78.7272727272727273,76.9090909090909091,75.3636363636363636,74.7272727272727273,74.4545454545454545,73.6363636363636364,72.9090909090909091,72.0909090909090909,71.8181818181818182,71.7272727272727273,71.000 :[K[K0000000000000,70.7272727272727273,71.0909090909090909,71.4545454545454545,71.4545454545454545,71.9090909090909091,72.9090909090909091,74.1818181818181818,75.3636363636363636,75.9090909090909091,75.8181818181818182,75.6363636363636364,74.7272727272727273,73.9090909090909091,73.363636363 :[K[K6363636,72.9090909090909091,72.2727272727272727,71.0909090909090909,70.0000000000000000,69.7272727272727273,70.0909090909090909,70.7272727272727273,72.2727272727272727,74.1818181818181818,76.0909090909090909,77.7272727272727273,79.2727272727272727,81.0909090909090909,83.363636363636363 :[K[K6,85.1818181818181818,86.9090909090909091,88.1818181818181818,89.3636363636363636,90.3636363636363636,91.8181818181818182,92.9090909090909091,94.0000000000000000,95.2727272727272727,95.6363636363636364,95.6363636363636364,96.0000000000000000,96.1111111111111111,96.5000000000000000,97.2 :[K[K857142857142857,97.8333333333333333,97.8000000000000000,97.5000000000000000,97.3333333333333333,95.5000000000000000,95.0000000000000000}
:[K[K           4 | {270.1818181818181818,267.5454545454545455,265.6363636363636364,263.9090909090909091,262.5454545454545455,261.0000000000000000,259.1818181818181818,258.2727272727272727,258.0000000000000000,258.0000000000000000,257.6363636363636364,257.4545454545454545,257.81818181818181 :[K[K82,257.4545454545454545,257.4545454545454545,257.3636363636363636,257.5454545454545455,257.7272727272727273,257.9090909090909091,257.4545454545454545,257.0909090909090909,256.8181818181818182,256.5454545454545455,255.8181818181818182,255.8181818181818182,255.4545454545454545,255.636363 :[K[K6363636364,256.0909090909090909,257.0909090909090909,257.7272727272727273,258.5454545454545455,259.4545454545454545,260.5454545454545455,262.0000000000000000,263.3636363636363636,264.2727272727272727,265.7272727272727273,266.4545454545454545,267.1818181818181818,267.0000000000000000,26 :[K[K6.4545454545454545,266.3636363636363636,266.3636363636363636,266.1818181818181818,265.2727272727272727,264.4545454545454545,263.4545454545454545,261.8181818181818182,260.9090909090909091,259.8181818181818182,258.8181818181818182,258.5454545454545455,258.4545454545454545,258.36363636363 :[K[K63636,258.6363636363636364,259.7272727272727273,261.2727272727272727,263.2727272727272727,265.8181818181818182,268.3636363636363636,271.1818181818181818,274.0000000000000000,276.8181818181818182,279.0000000000000000,280.3636363636363636,281.8181818181818182,282.4545454545454545,283.363 :[K[K6363636363636,283.7272727272727273,284.1818181818181818,283.8181818181818182,283.0909090909090909,282.9090909090909091,282.4545454545454545,282.1818181818181818,282.3636363636363636,282.0000000000000000,282.4545454545454545,282.1818181818181818,282.6363636363636364,282.8181818181818182 :[K[K,283.0909090909090909,283.6363636363636364,283.9090909090909091,283.6363636363636364,283.8000000000000000,283.8888888888888889,284.2500000000000000,284.1428571428571429,284.5000000000000000,284.2000000000000000,283.2500000000000000,283.0000000000000000,282.0000000000000000,280.00000000 :[K[K00000000}
:[K[K           5 | {226.9090909090909091,224.2727272727272727,221.8181818181818182,219.4545454545454545,217.4545454545454545,216.0909090909090909,214.1818181818181818,212.0909090909090909,210.0909090909090909,208.1818181818181818,206.2727272727272727,204.0909090909090909,202.09090909090909 :[K[K09,199.7272727272727273,197.9090909090909091,196.3636363636363636,194.2727272727272727,192.0909090909090909,190.5454545454545455,189.1818181818181818,188.5454545454545455,187.8181818181818182,188.0000000000000000,188.5454545454545455,189.6363636363636364,190.9090909090909091,191.545454 :[K[K5454545455,192.4545454545454545,194.0909090909090909,195.4545454545454545,196.9090909090909091,197.5454545454545455,198.9090909090909091,199.9090909090909091,200.9090909090909091,202.2727272727272727,203.0000000000000000,204.4545454545454545,206.0000000000000000,207.5454545454545455,20 :[K[K9.4545454545454545,211.2727272727272727,213.1818181818181818,214.6363636363636364,215.5454545454545455,216.4545454545454545,217.1818181818181818,217.8181818181818182,218.4545454545454545,219.2727272727272727,219.3636363636363636,219.2727272727272727,219.8181818181818182,220.63636363636 :[K[K36364,221.0909090909090909,222.0909090909090909,223.1818181818181818,223.7272727272727273,224.6363636363636364,225.4545454545454545,226.0000000000000000,227.2727272727272727,228.5454545454545455,229.5454545454545455,230.1818181818181818,231.6363636363636364,233.1818181818181818,234.818 :[K[K1818181818182,236.5454545454545455,238.5454545454545455,240.5454545454545455,242.2727272727272727,243.7272727272727273,245.3636363636363636,246.9090909090909091,249.2727272727272727,250.9090909090909091,252.8181818181818182,254.0909090909090909,255.9090909090909091,257.5454545454545455 :[K[K,259.2727272727272727,260.6363636363636364,261.7272727272727273,262.0909090909090909,262.4545454545454545,262.5454545454545455,262.7272727272727273,262.1818181818181818,261.4545454545454545,260.1818181818181818,258.5454545454545455,256.4545454545454545,255.0000000000000000,254.09090909 :[K[K09090909,253.5454545454545455,252.6363636363636364,251.7272727272727273,250.6363636363636364,249.6363636363636364,248.7272727272727273,247.8181818181818182,247.3636363636363636,247.5000000000000000,247.4444444444444444,246.7500000000000000,245.7142857142857143,244.8333333333333333,243. :[K[K4000000000000000,242.5000000000000000,241.6666666666666667,241.5000000000000000,243.0000000000000000}
:[K[K[?1l>Time: 16924.706 ms (00:16.925)
nyu_adv_database=# SELECT t2.stocksymbol, array_agg(t2.total_prices/t2.quantities) AS weighted_avg
nyu_adv_database-# FROM (
nyu_adv_database(#   SELECT t.stocksymbol,
nyu_adv_database(#     AVG(t.price*t.quantity)
nyu_adv_database(#     OVER(
nyu_adv_database(#       PARTITION BY t.stocksymbol
nyu_adv_database(#       ORDER BY t.time ROWS BETWEEN CURRENT ROW AND 10 FOLLOWING
nyu_adv_database(#       ) AS total_prices,
nyu_adv_database(#     AVG(t.quantity)
nyu_adv_database(#     OVER(
nyu_adv_database(#       PARTITION BY t.stocksymbol
nyu_adv_database(#       ORDER BY t.time ROWS BETWEEN CURRENT ROW AND 10 FOLLOWING
nyu_adv_database(#       ) AS quantities
nyu_adv_database(#   FROM trade t
nyu_adv_database(# ) t2
nyu_adv_database-# GROUP BY t2.stocksymbol;
[?1h= stocksymbol |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        weighted_avg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- :[K[K--------------------
:[K[K           1 | {366.1583251323867098,367.5919217707555577,369.6826297089135568,370.3799550490283827,370.9517743020517994,371.6589737636405851,371.9361325407866448,372.1930345362824991,371.7353865910902489,371.2598532748782799,371.6532990864813783,371.5084245573323917,370.32060792087649 :[K[K75,369.5651747722057611,369.2399002237251523,368.3787885874649205,368.0507147559484624,367.5193075898801598,366.6844286259056819,366.3667827708006280,365.4397053426309441,365.0865621388009447,364.8799899383725316,363.9688059701492539,363.3909139784946237,363.4933667492985370,364.527238 :[K[K9486913284,365.6091942659416708,367.4127457117816451,370.0653622511777939,373.1274677791849810,375.9596280335677024,377.9056267390905909,380.1611768125698024,384.5116042981195727,386.6325816131672275,387.9218473755905284,389.8116344699173746,392.8888186454250433,395.8579460485448062,39 :[K[K8.0926810924303913,401.1079436205253390,403.7707777721867190,406.9147008255758120,408.7667143135598727,411.8137211797189638,413.4229450792480649,415.1732704995287464,416.8030587465339373,418.7189449364651522,420.1784032534246576,420.0564418800734042,420.2454346471537442,420.53212037595 :[K[K92999,420.6331545490663488,420.1285955658122475,417.9604743798660149,416.7089978883032603,416.2471482889733840,414.7060875252057332,413.4372936764847280,411.7999659419878526,410.9172465409822802,409.8104814543517346,410.7592338187384699,411.1090081334083584,412.2703621603810322,413.050 :[K[K3088399095419,414.3166725995922463,414.1967808406703460,414.7109847790207226,415.7871190722644256,415.7358026741964954,415.6543307945111599,415.5237721131858420,415.1472896681507320,414.3501323781342471,413.0666224946165314,412.6919571971004487,411.8393061036437571,411.6033119606614280 :[K[K,411.3293311845286059,411.2616533537586170,410.9744604968869008,410.6875410977449426,408.7693012460298069,408.4052602963164333,409.0000000000000000}
:[K[K           2 | {256.8241711008018498,256.1163601982263954,254.1034633784785392,253.2820112219870309,253.6105115781525296,254.3974463263705297,254.5658276863504356,254.9109677419354839,254.8891084032092659,255.2159873565130593,255.2086385248008224,255.2170175724933355,254.29683232296316 :[K[K04,254.4690367175208159,253.5051462068025356,251.7022088385072603,250.4818540024885940,249.4207515482313424,248.9343884288858611,249.7213679873013836,249.8531824471239375,250.2911105732660258,251.0129104640064301,253.3666209105467857,254.3907320240220743,255.8200238157258215,260.473701 :[K[K4488286067,260.8351765826352311,262.8656732169618168,265.4440576946000714,267.4895267277906783,268.3316909102594315,269.2597109111840702,269.8101285846647533,271.4938977986978214,271.2837742681822754,270.7362555720653790,268.5550942625740148,267.7771305119401257,267.4617771619274380,26 :[K[K7.1383365526644700,267.0226563607998865,267.2204973835733913,267.4442226357638301,267.7212321413824428,268.6505011990050493,269.6959773270220943,271.0809686181587007,273.6543663206249906,276.1241022292696578,276.5869485797789753,277.5457742299246247,278.8342606444672304,279.67940361609 :[K[K78812,280.6332444707740916,280.4904181964717472,281.0272556390977444,282.0040333858360443,282.1077530191131256,281.5902764384442302,281.1616269275068332,281.4650010950319244,281.9598279079411155,281.9758948013064779,281.8770753009678181,281.6156368116607847,280.8819266652202212,280.306 :[K[K7042981176302,278.9737781097004397,278.7293344695824285,278.5604780484807519,276.7359673383379427,275.4105922857603960,274.6721574469304152,275.9985549132947977,276.5540094173870266,276.8610945729333640,277.8486195252755983,278.1992324764194564,278.6720034227296270,279.7928894369091656 :[K[K,280.5027362639549462,283.0305216313425859,283.7102131133453638,284.4016308791256077,285.5167333288138658,285.7900048053820279,286.7073458908000272,288.5933300373050475,293.1313178925717224,295.3151539464446896,297.7968176990441074,299.2519281204468188,301.2891995499812493,301.42555277 :[K[K43012098,302.3458405923344947,303.5282651508369886,302.7590224725931631,301.9962257400948037,301.0401926814839855,299.5890350374289505,299.0815534327931021,297.4908035552330855,296.2513042371803029,294.9639138423846469,294.1599923933885869,293.5513875418452587,292.2996346899692625,291. :[K[K0940900035756244,287.8044923217969286,283.6551486065504757,279.9007200771106197,278.6063208519409139,275.7330558524101467,273.8153272705983372,271.2284023419401037,269.7220027176753423,269.1665472103813799,268.6298348006726679,268.1875136871304475,268.1652619169115448,268.4384375941359 :[K[K574,268.8729339490565643,270.3205206904022533,271.5666533493141564,273.7762446898895497,274.3778284111821926,276.9193532338308459,280.1071866925064600,281.3734439834024896,284.2741615592239670,287.3233836821717066,288.1559951280430459,288.5286998564629448,289.8900758416574178,290.23977 :[K[K61790567546,290.8346751476601544,290.5433435708072219,290.5630314691825462,288.7881320254283669,287.9269512857660269,286.7580314084332879,284.9769694860192599,284.6715060707827435,284.9415782589739862,285.0506722404248109,284.9190554538502536,283.7666353725595386,283.5879803142154080,2 :[K[K83.6344281203320288,284.0001691689574964,284.0952833305798777,284.5808195024723063,284.5280691361466355,285.0950637175919144,285.1402664446294755,286.5799041923294356,287.8173308371222251,290.8042877895375382,291.7227748691099476,292.5842933767089220,293.0829647169025812,293.6504134694 :[K[K181629,295.0190411555305145,296.9801981433419845,298.5485923819899294,299.8718726404832290,301.7435397367137981,302.7208599040168300,304.1327249776468731,304.9834842387659289,306.7004041989310196,307.9360935315063359,309.1293553684771190,310.1581441200788653,311.8362594489148988,312.80 :[K[K10639787204256,313.5300406565276314,314.1793568922209651,314.0411318375068655,314.6230948577349854,314.8124081396070963,315.8831702909838620,317.4581439231494982,318.1443142315938469,318.9611687326081458,319.5348076122734667,319.8652616623253611,320.3607089015881921,321.132992173389524 :[K[K3,320.9405071405676841,321.8209878624409980,321.6458846048673777,321.3733929760461661,320.8803990650089772,321.0383833782978873,321.5096850172256205,321.3863926712990372,321.2586488328235686,321.4412676313128802,321.7093635221725788,322.1329142343960486,322.1332497307030660,323.0328281 :[K[K657938237,323.3019015534941644,323.8608189198729263,323.9888704444276768,323.5741979522184301,323.9914798077199851,324.0889334473505735,324.1101614434947768,323.6952925942943068,323.9403457236470455,326.0000000000000000}
:[K[K           3 | {104.3456262465909552,106.0343176540698271,107.9229366458561284,107.7052926947266570,107.8497127305715151,108.6190837954873510,107.0964372189553787,106.3040480376264299,104.5863494886616274,99.7123216713789307,96.6028802880288029,93.0052880551108873,90.0057844368576533,8 :[K[K6.0658314953683283,83.2389030466699631,80.9044428109882220,80.2099556507111180,78.2885088419093206,77.3081208657119004,76.6562036412677006,75.8551415283918012,75.4446078431372550,74.0359372044637792,73.3015093015093016,71.9640568720379146,71.5750068719076416,71.3717667937922442,70.4773 :[K[K945564097237,70.4564305471597882,71.1013382056877971,71.1775974080197740,71.1978536779852483,71.6245655895015301,72.6444333712984054,74.3586106564829969,75.7030082968035671,76.7444390766451722,76.6028533510285335,75.3206025338833235,74.2124252290452034,73.1024384365082554,72.8353618970 :[K[K839805,72.6678380443086326,71.8353239300154653,70.6001078684005513,68.3665812315578626,69.5367501856984981,70.7537496591218979,71.0759541175126862,72.9930030354478572,75.5944423396860433,76.7183999421839994,78.3143352298737819,79.7064834233189058,81.8172138688222963,82.7403819255289389 :[K[K,83.6146233336455308,85.7425453193897722,87.6935922330097087,88.2863081038097303,89.5297466904052601,91.8143400504699558,92.1442928039702232,93.6975244396535702,95.4665711749515817,96.0023388032172805,95.8943064603691640,95.9430730911277162,96.0254585528036160,96.4560991742590735,96.64 :[K[K14719703487987,97.1307690296263368,96.9412027009810167,96.7824968266492847,96.4913063809888194,95.5010628921034894,95.0000000000000000}
:[K[K           4 | {272.3637553993648691,268.4927619215409913,265.5558422791081751,263.6491207483278292,262.2350680868275584,259.6079994684738555,257.8057723389517432,257.6001394741527688,257.6656625290818865,257.4579779711138731,256.9139183901621017,256.8979622558881088,257.39829508378802 :[K[K40,256.8834261063178402,256.9626409837383127,256.8824517815340868,257.3515705578996718,257.9955065078162661,258.1674595158189697,257.7766482151728054,257.5727060782681099,257.2396539587269831,256.8603434998298618,256.0198005954164919,256.0200660092736954,255.7222233172366217,255.853102 :[K[K1897810219,256.3231003660825451,257.2856281585246920,258.3434783360121671,258.9668751487134164,259.6076051489834701,260.6699389216870544,262.3283087449219586,263.4827770317277979,264.8160289001873161,266.4599783248180834,266.7610050450093976,267.3753016343095316,267.4361477002807169,26 :[K[K7.5633384702733392,267.3137316479547774,267.2839762358225078,267.1015113918339725,266.6651913487356525,265.9642533229085222,265.1822941917967614,263.9355202768790910,262.7643841166936790,261.1242276354648848,260.1966105054509415,260.1859364705412582,260.0273950097545949,259.67261892227 :[K[K67378,260.4717791534754291,262.1785450417169733,263.1801190901065049,265.0160322520157510,266.0328556196121664,268.9096249672174141,271.8137132901941264,273.9358639971478430,274.5114785038927101,276.0169051488366563,278.2730211427572951,280.6960776758881096,281.9731458113836277,282.939 :[K[K1977391597772,283.1354255732607851,283.2819266279924830,282.7783258378064703,281.7875109425153195,281.7012405629955613,281.4623457998825142,281.4735585618172612,281.6981777536919117,281.5411381169103645,281.9728223376057514,281.4401772810482705,281.8051422887293487,282.7922324080992910 :[K[K,283.0329507516643291,283.8204563191479595,284.0278245529628738,283.4274737149031782,283.5547252993592498,283.6454031732232123,283.9562566792966093,283.8848898461219087,284.2323365807185223,284.0608206061832035,282.3476367858352281,282.2161174074267509,282.0665896208243905,280.00000000 :[K[K00000000}
:[K[K           5 | {227.7826000988630747,225.4695712429623214,223.7992644110930991,221.8468362237863725,220.0764968213302969,217.8584412120714768,214.6202485893857553,211.6480349169314937,210.5049192912988141,207.1903594936708860,205.4337660938425900,202.5255984536848888,200.91452471969418 :[K[K27,198.3388418747780802,197.2599774123997125,196.7358287288566020,194.9176135914658237,192.4463615512927439,190.5520339363004604,189.8756307660940924,188.8388150807899461,187.7974678952332584,187.9194466735450343,188.8161158911967264,190.4302629819904126,191.8548203603801975,192.367111 :[K[K6603522009,193.2822558332564789,194.7206900449292153,195.3650079407093700,196.7367524060494958,197.2244646880745359,198.5033338102732866,199.3578555096950441,200.2706418389786265,201.1066756574511125,201.9929542191204461,203.5299558619234353,205.7914238573334270,207.8956658700847274,20 :[K[K9.9013855847746416,212.7675715640419821,215.3047855041040731,216.4409411555923631,217.1439468352876174,217.5490718038528897,217.8722993978985478,218.4054507550719479,218.7809915157318014,219.2180036019013315,219.2275147883059821,218.9260256741065669,219.7480642757637606,220.61176695918 :[K[K65162,221.0580219950134327,221.7135981741201376,223.5718917275966296,224.3006210151527696,225.7886514185726784,226.1783097751910013,226.2054104769351055,226.7853887803871132,227.8204294390512171,229.5439668646452016,229.9460044242786327,230.9307403101360431,232.5920211146076540,233.419 :[K[K2594345202888,236.4868670511098824,238.5253373372582334,242.3063340862221349,242.8897977857077500,243.4357469257346659,244.1695523101751309,247.1114736382717846,248.5895659520540712,250.4422552971110760,252.2343645575078149,253.1658574814588272,256.2212788078322648,257.7254775577170983 :[K[K,259.6573148126959427,261.3284284138447770,261.7137496431047845,261.5396861576225124,262.1801498554693442,262.2325911330049261,262.0837156171238962,261.6330098158155951,260.4762881815586641,259.8373216561819005,258.8406553293824615,258.4651014250159680,256.1289590056173061,255.26266997 :[K[K60283416,254.1391563393708293,253.1081842422157233,252.8356663436344712,251.6375966709849645,250.2485942480570179,249.0100499752869461,248.3408497345646349,248.0102008814353861,248.0176944232744624,248.0192487924446687,247.2132506910126476,246.6318996089842685,245.6739106331078833,243. :[K[K3425135617009977,242.9366571139581929,241.6773668137088565,241.4189684673673918,243.0000000000000000}
:[K[K           6 | {337.3014360120616579,338.2952792808146224,338.9234780757769263,339.3037946864621996,339.8607268222176337,340.8693632425872062,341.5326679973386559,341.9454405434224557,343.1157087685253886,343.6035165155853868,344.3309386553591141,345.4747521006730118,349.10347015665278 :[K[K61,351.0549623359478140,352.0224294698311949,354.4823920859293004,357.7095369337905788,359.5934426878252439,360.6402014357655631,362.4748147879140036,362.1452660381090526,362.1324707638716099,361.7683806809568565,360.5715955497193321,360.2865029179392323,360.2182800848327290,360.077182 :[K[K6872744304,359.6235003478483097,359.5962791836235121,359.3936357982147959,359.9872259400303175,361.8101539942252166,363.3533827011233691,364.1664954135296205,366.6875807344528511,369.1515202671018325,370.0984571660576532,370.5208102108768035,371.9706449126413156,372.6880730181519844,37 :[K[K2.8534519182017914,372.8968410757946211,374.1455088753883600,374.8051525136327727,374.6043080962498488,374.8449589324179961,374.6274518039396866,374.6347987511602397,374.3686625177884922,373.9861519819975767,373.9103219855777293,373.0634806131650135,373.0758396730702571,372.24591631646 :[K[K26348,371.5015092712376023,371.3348058440718872,370.8090770038581831,370.1515355862972526,370.0116107240869749,369.6205769129357170,369.1944181301464694,369.1422939464279136,369.6105213833870996,369.2677224586756409,368.9696664923361629,369.3727097307727649,369.0885451929587001,368.980 :[K[K[?1l>Time: 24580.586 ms (00:24.581)
nyu_adv_database=# SELECT t1.stocksymbol,MAX(t1.diff)
nyu_adv_database-# FROM (
nyu_adv_database(#   SELECT t.stocksymbol,
nyu_adv_database(#     t.price - MIN(t.price)
nyu_adv_database(#     OVER (
nyu_adv_database(#       PARTITION BY t.stocksymbol
nyu_adv_database(#       ORDER BY t.time
nyu_adv_database(#       ROWS UNBOUNDED PRECEDING
nyu_adv_database(#       ) AS diff
nyu_adv_database(#   FROM trade t
nyu_adv_database(# ) t1
nyu_adv_database-# GROUP BY t1.stocksymbol;
[?1h= stocksymbol | max 
-------------+-----
           1 |  76
           2 |  84
           3 |  40
           4 |  36
           5 |  85
           6 |  48
           7 |  23
           8 |  63
           9 |  78
          10 |  42
          11 |  43
          12 |  76
          13 |  17
          14 |  59
          15 |  49
          16 |  28
          17 |  54
          18 |  59
          19 |  21
          20 |  30
          21 |  72
          22 |  65
          23 |  26
          24 |  37
          25 |  15
          26 |  23
          27 |  47
          28 |  42
          29 |  26
          30 |  46
          31 |  58
          32 |  45
          33 |  37
          34 |  88
          35 |  72
          36 | 179
          37 |  18
          38 |  16
          39 |  25
          40 |  19
          41 |  31
          42 |  74
          43 |  57
          44 |  49
          45 |  24
          46 |  31
          47 |  29
          48 |  21
          49 |  31
          50 |  38
          51 |  21
          52 |  26
          53 |  25
          54 |  50
          55 |  33
          56 |  23
          57 |  75
          58 |  66
          59 |  40
          60 |  30
          61 |  45
          62 |  50
          63 |  40
          64 |  44
          65 |  24
          66 |  36
          67 |  48
          68 |  42
          69 |  83
          70 | 107
          71 |  30
          72 |  52
          73 |  29
          74 |  27
          75 |  23
          76 |  27
          77 |  25
          78 |  42
          79 |  25
          80 |  28
          81 |  27
          82 |  63
          83 |  39
          84 |  84
          85 |  92
          86 |  17
:[K[K[?1l>Time: 10488.660 ms (00:10.489)
nyu_adv_database=# \q
bash-3.2$ exit
exit

Script done on Tue Nov 14 17:46:58 2017
